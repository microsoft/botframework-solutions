---
category: Clients and Channels
subcategory: Clients
title:  Virtual Assistant Client (Android)
description: Chat with your Virtual Assistant using the **Virtual Assistant Client**  app and set it up as the default assistant on a device.
order: 1
toc: true
---

# {{ page.title }}
{:.no_toc}
{{page.description}}

## Prerequisites
1. Install [Android Studio](https://developer.android.com/studio/).

1. Download the [**Virtual Assistant Client** app source code](https://aka.ms/bfvirtualassistantclient).

1. [Create a Virtual Assistant]({{site.baseurl}}/virtual-assistant/tutorials/create-assistant/csharp/1-intro) to setup your Virtual Assistant environment.

1. [Enable speech]({{site.baseurl}}/clients-and-channels/tutorials/enable-speech/1-intro) on your new Virtual Assistant

1. If you want to capture analytics, get started with [Visual Studio App Center](https://docs.microsoft.com/en-us/appcenter/sdk/getting-started/android) and register a new app.

1. If you want to enable authentication, get started with the [Linked Accounts solution accelerator]({{site.baseurl}}/solution-accelerators/samples/linked-accounts/).

## Build and run

### Add your application settings
{:.no_toc}

There are two configuration files used to provide your environment settings.

#### [Direct Line Speech configuration]({{site.repo}}/blob/master/samples/android/clients/VirtualAssistantClient/directlinespeech/src/main/assets/default_configuration.json)
{:.no_toc}
```json
{
  "SpeechSubscriptionKey": "SPEECH_SERVICE_SUBSCRIPTION_KEY", // Replace with your Speech Service subscription key
  "SpeechRegion": "westus2",
  "CustomCommandsAppId": "", // Optional, if you are connecting to a Custom Commands application
  "CustomVoiceDeploymentIds": "", // Optional, to point to custom voices
  "CustomSREndpointId": "", // Optional, to point to a customized speech recognition endpoint
  "TTSBargeInSupported": false, // Whether or not to listen to keyword while TTS is playing. If true, TTS playback stops once Keyword is verified.
  "SpeechSDKLogEnabled": false, // Optional, whether to log Direct Line Speech activites. The default file path is on the device internal storage at Android/data/com.microsoft.bot.builder.solutions.virtualassistant/files/SpeechSDK.log
  "UserId": "android",
  "UserName": "Android",
  "SRLanguage": "en-us",
  "Keyword": "computer",
  "EnableKWS": false, // Keyword spotting
  "LinkedAccountEndpoint": "" // Optional if you enabled the Linked Accounts solution in the prerequisites
}
```

The **UserId** is a unique identifier for all messages generated by the user, this can be combined with [Linked Accounts sample]({{site.baseurl}}/solution-accelerators/samples/linked-accounts/).

#### [App configuration]({{site.repo}}/blob/master/samples/android/clients/VirtualAssistantClient/app/src/main/assets/default_app_configuration.json)
{:.no_toc}
```json
{
  "history_linecount": 2147483646,
  "show_full_conversation": true,
  "enable_dark_mode": false,
  "keep_screen_on": true,
  "app_center_id": "APP_CENTER_ID" // Replace with your Visual Studio App Center id
}
```

#### Optional: [Chat colors]({{site.repo}}/blob/master/samples/android/clients/VirtualAssistantClient/app/src/main/res/values/colors.xml)
{:.no_toc}
```xml
<?xml version="1.0" encoding="utf-8"?>
<resources>
...
    <!-- Chat -->
    <color name="color_chat_text_bot">#000000</color>
    <color name="color_chat_text_user">#ffffff</color>
    <color name="color_chat_background_bot">#f2f2f2</color>
    <color name="color_chat_background_user">#3062d6</color>
...
</resources>
```

### Run
{:.no_toc}
[Build and run your app](https://developer.android.com/studio/run) to deploy to the Android Emulator or a connected device.

#### Permissions
{:.no_toc}
##### Record Audio
{:.no_toc}
Required for the user to make voice requests to a bot. With this a user can only use the keyboard.
##### Fine Location
{:.no_toc}
Allow Virtual Assistant to receive the [**VA.Location** event]({{site.baseurl}}/virtual-assistant/handbook/events/) with GPS coordinates to utilize location-based skills like Point of Interest.

## Interact with a Virtual Assistant
### Chat
{:.no_toc}
The main view shows an expected user and assistant chat window. Start a conversation by selecting the microphone or keyboard icons.

![Widgets]({{site.baseurl}}/assets/images/android-virtual-assistant-client-chat.png)

### Widget
{:.no_toc}
Using widgets, you can demonstrate an Assistant having a native chat experience on a device.

![Widgets]({{site.baseurl}}/assets/images/android-virtual-assistant-client-widget.png)

### Side menu
{:.no_toc}
Swipe from the left to access the menu.

![Side menu]({{site.baseurl}}/assets/images/android-virtual-assistant-client-side-menu.png)

### Sign in
{:.no_toc}
If you enabled the Linked Accounts solution, the optional **Sign in** option will appear.

### Restart conversation
{:.no_toc}
Restart the conversation with a Virtual Assistant with a new conversation id.

### Settings
{:.no_toc}
Access the same settings from the configuration files.

![Settings]({{site.baseurl}}/assets/images/android-virtual-assistant-client-settings.png)

## Set as default assistant
{:.no_toc}

Set your Virtual Assistant as the device's default assist app.

1. Allow the **Appear on top** permission to overlay this app on Android
![Settings]({{site.baseurl}}/assets/images/android-virtual-assistant-client-appear-on-top.png)

1. Select **Device assistance app**
![Settings]({{site.baseurl}}/assets/images/android-virtual-assistant-client-device-assistance-app-1.png)

1. Select **Virtual Assistant**
![Settings]({{site.baseurl}}/assets/images/android-virtual-assistant-client-device-assistance-app-2.png)

## Authenticating users

If you provided a [Linked Accounts solution]({{site.baseurl}}/solution-accelerators/samples/linked-accounts/) endpoint in the app's configuration settings, a **Sign in** option will be available on the side menu.

1. Select **Sign in** and authenticate with the Linked Accounts app.
![Side menu with sign-in]({{site.baseurl}}/assets/images/android-virtual-assistant-client-side-menu-signin.png)

1. The user id that will be used in each outgoing Activity is highglighted at the top, next to a **Sign out all** button that will unlink all of your accounts with a bot. There is a row for each authentication provider enabled on your bot, select **Link** to sign in with that specific account.
![Linked accounts with unlinked account]({{site.baseurl}}/assets/images/linked-accounts-unlinked.jpg)

1. After linking an account, the button will change to **Unlink**. SelecT **Complete and return to app** to pass the user id back to the Android app.
![Linked accounts with linked account]({{site.baseurl}}/assets/images/linked-accounts-linked.jpg)

1. Return to the app and the side menu now shows **Sign out**. Any future conversations with your Virtual Assistant will now pass the linked user id.
![Side menu with sign-out]({{site.baseurl}}/assets/images/android-virtual-assistant-client-side-menu-signout.png)

## Events
The **Virtual Assistant Client** is enabled to work with [events used in the sample Skills]({{site.baseurl}}/virtual-assistant/handbook/events/). 

### Open default apps
{:.no_toc}
#### [OpenDefaultApp](https://github.com/microsoft/botframework-solutions/blob/8e05d16bacaac483810807cab67b9120d07c5302/samples/android/clients/VirtualAssistantClient/app/src/main/java/com/microsoft/bot/builder/solutions/virtualassistant/service/SpeechService.java#L502)
{:.no_toc}
This method takes the metadata from an **OpenDefaultApp** event to open default apps on the device.

#### Maps
{:.no_toc}
Compatible with either [Waze](https://www.waze.com/) or [Google Maps](https://www.google.com/maps) (in this order).

#### Phone
{:.no_toc}
Compatible with the default dialer.

#### Music
{:.no_toc}
Compatible with [Spotify](https://www.spotify.com/).

### Other events
{:.no_toc}
#### [BroadcastWidgetUpdate](https://github.com/microsoft/botframework-solutions/blob/master/samples/android/clients/VirtualAssistantClient/app/src/main/java/com/microsoft/bot/builder/solutions/virtualassistant/service/SpeechService.java#L579)
{:.no_toc}
This method sends the value of this event activity to any listening apps, like the [**Event Companion**]({{site.baseurl}}/clients-and-channels/clients/event-companion) app.

## Next steps
Use the [**Event Companion**]({{site.baseurl}}/clients-and-channels/clients/event-companion) app to broadcast your Virtual Assistant's metadata and prototype advanced scenarios.
